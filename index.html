<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Shelter Locator — San Mateo, Isabela</title>
<link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"/>
<link rel="stylesheet" href="https://unpkg.com/leaflet-routing-machine@latest/dist/leaflet-routing-machine.css"/>
<link rel="stylesheet" href="https://unpkg.com/leaflet-control-geocoder/dist/Control.Geocoder.css"/>
<meta name="theme-color" content="#0078d7">
<link rel="manifest" href="manifest.json">
<link rel="apple-touch-icon" href="icon-192.png">
<style>
html,body {height:100%; margin:0; font-family:Arial, sans-serif;}
#map {height:100%;}
</style>
</head>
<body>
<div id="map"></div>
<script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-auth-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-firestore-compat.js"></script>
<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
<script src="https://unpkg.com/leaflet-routing-machine@latest/dist/leaflet-routing-machine.js"></script>
<script src="https://unpkg.com/leaflet-control-geocoder/dist/Control.Geocoder.js"></script>
<script>
const firebaseConfig = {
  apiKey: "AIzaSyDnELgmIyXPVQAk69rz9db1m4fV64QIQeE",
  authDomain: "shelter-dcdab.firebaseapp.com",
  projectId: "shelter-dcdab",
  storageBucket: "shelter-dcdab.firebasestorage.app",
  messagingSenderId: "192730355402",
  appId: "1:192730355402:web:73a661300ab80e6db4c633",
  measurementId: "G-TSKM5XS577"
};
firebase.initializeApp(firebaseConfig);
const db = firebase.firestore();

/* ------------------ Default shelters (seed) ------------------ */
const defaultShelters = [
  { name: "Malasin", coords: [16.86909, 121.59931], capacity: "100" },
  { name: "SMGCHS", coords: [16.88988, 121.5678], capacity: "100" },
  { name: "NCC", coords: [16.88115, 121.58619], capacity: "400" },
  { name: "SMVHIS", coords: [16.90235, 121.61287], capacity: "300" },
  { name: "San Mateo Evac Center", coords: [16.88025, 121.60092], capacity: "250" },
  { name: "Barangay 4 Hall", coords: [16.88573, 121.59388], capacity: "150" },
  { name: "Isabela Sports Complex", coords: [16.87745, 121.58215], capacity: "500" },
  { name: "San Mateo Gymnasium", coords: [16.89112, 121.60545], capacity: "350" }
];

async function seedDefaultShelters() {
  try {
    for (const s of defaultShelters) {
      const docRef = db.collection("shelters").doc(s.name);
      const doc = await docRef.get();
      if (!doc.exists) {
        await docRef.set({
          name: s.name,
          coords: s.coords,
          capacity: s.capacity,
          currentOccupancy: 0,
          status: "available"
        });
        console.log("✅ Seeded:", s.name);
      }
    }
  } catch (err) {
    console.error("Seed error:", err);
  }
}
seedDefaultShelters();

const map = L.map('map').setView([16.8827,121.5945],14);
L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png',{maxZoom:19}).addTo(map);
</script>
</body>
</html>
